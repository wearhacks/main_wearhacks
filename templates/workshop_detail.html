
{% extends "_base.html" %}
{% load staticfiles %}
{% block title %} {{ title }} {% endblock %}
{% block stylesheets %}
    <link href="{% static 'scss/workshop.scss' %}" media="screen, projection" rel="stylesheet" type="text/x-scss" />
{% endblock %}
{% block script_section %}
    <script src="{% static 'bower_components/jquery.lazyload/jquery.lazyload.js' %}"></script>
    <script src="{% static 'parsley/js/parsley.min.js' %}"></script>
    <script src="https://checkout.stripe.com/checkout.js"></script>
    <script src="{% static 'javascript/register.js' %}"></script>
   	<script>
	var markers = [
        {
            name:"{{ event.event_name }}",
            position: {lat:{{ event.location.latitude}},lng:{{ event.location.longitude}} } ,
            date:"{{ event.date }}",
            address:"{{ event.address }}",
            city:"{{ event.city }}",
            url:"{{ event.link }}"
        },
    ];

	function initMap() {
		var customMapType = new google.maps.StyledMapType();
		var customMapTypeId = 'wearhacks';
		var map = new google.maps.Map(document.getElementById('map'), {
		    zoom: 15,
		    center: {lat:{{ event.location.latitude}},lng:{{ event.location.longitude}}},
		    mapTypeControlOptions: {
		      mapTypeIds: [google.maps.MapTypeId.ROADMAP, customMapTypeId]
		    }
		});
		var addMarker = function (event, map) {
        	var contentString = '<div class="map-tag-content">' +

                '<h4 id="firstHeading" class="firstHeading">'+event.name+'</h4>' +
                '<div id="bodyContent">' +
                '<p>'+event.date+'</p><p>'+event.address+'</p><p>'+event.city+'</p>' +
                '</div>';

	        var infowindow = new google.maps.InfoWindow({
	            content: contentString
	        });
	        var marker = new google.maps.Marker({
	            position: event.position,
	            map: map,
	            title: event.name
	        });
	        marker.addListener('click', function () {
	            infowindow.open(map, marker);
	        });
    	};
		markers.forEach(function(event) {
		  addMarker(event,map);
		});
		map.mapTypes.set(customMapTypeId, customMapType);
		map.setMapTypeId(customMapTypeId);
	}

   	</script>
{% endblock %}
{% block content %}

<section id="body">

    <div class="columns small-12 top-header" style="background-image: url('{{ event.photo.url }}'); background-position-y: 70%" alt="">
        <div class="row"><h2 class="sub-header"><span><a href="/">Home</a> &gt; <a href="/workshops">Workshops</a> &gt; </span> {{ title }}</h2></div>
    </div>

    {% if event.iconable_extensions|length %}
    <div class="workshop-extensions text-center">
        {% for extend in event.iconable_extensions %}
        <div>
            <h1>
                <i class="fa fa-{{ extend.extendKey.icon }}"></i>
            </h1>
                {{ extend }}
        </div>
        {% endfor %}
    </div>
    <div class="small-brk"></div>
    {% endif %}

    <div class="row text-right ticket-displayer">
    	<span>Available for</span>
    	{% for ticket in tickets %}
    		<div class="event-ticket">
    			{{ ticket.title }} <b>${{ ticket.displayedPrice }}</b>
    		</div>
    	{% endfor %}
    </div>

    <div class="row">
    	{% for content in contents %}
    		<div class="column {{content.size}}">
    			{{ content.html | safe }}
    		</div>
    	{% endfor %}
    </div>

    <div class="small-brk"></div>

    <div class="row text-center">
    	<h3>Join us</h3>
    	<i class="fa fa-map-marker"></i> {{ event.address }}<br>
    	{{ event.city }}<br>
    	<i class="fa fa-calendar"></i> {{ event.start_date }}<br>
  		<br>
        <a class="button" href="{{ event.link }}" target="_blank">Register</a>
    	<!-- <button data-reveal-id="register-modal" class="button">Register</button> -->
    </div>
  	<br>
    <div class="row collapse">
    <div class="columns large-12 ">
        <div id="map" style="height:400px;"></div>
        <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCo2CgBucjUSXSld3KMWIAVynCtp36acFs&signed_in=false&callback=initMap"></script>
    </div>
</div>

</section>

<!-- <div id="register-modal" class="reveal-modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true" role="dialog">
      <form id="register-form" data-validate="parsley" data-event="{{ event.slug }}" data-title="{{ title }}">
        <div class="small-10 columns medium-12 no-padding">
          <h6>Register for {{ title }}</h6>
            {{ form }}<br>
        </div>
      </form>
      <div class="success-messages"></div>
      <div class="error-messages"></div>
      <button id="register-submit" class="button">Register</button>
      <a class="close-reveal-modal" aria-label="Close">Ã—</a>
</div> -->

{% endblock %}